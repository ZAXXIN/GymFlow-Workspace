<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gymflow.mapper.CoachMapper">

    <select id="selectCoachPage" resultType="com.gymflow.entity.Coach">
        SELECT
        c.*,
        u.username,
        u.avatar as user_avatar
        FROM coach c
        LEFT JOIN user u ON c.user_id = u.id
        WHERE u.deleted = 0
        <if test="keyword != null and keyword != ''">
            AND (
            c.real_name LIKE CONCAT('%', #{keyword}, '%')
            OR c.coach_no LIKE CONCAT('%', #{keyword}, '%')
            OR c.phone LIKE CONCAT('%', #{keyword}, '%')
            OR c.email LIKE CONCAT('%', #{keyword}, '%')
            )
        </if>
        ORDER BY c.create_time DESC
    </select>

    <select id="selectCoachCourses" resultType="com.gymflow.entity.Course">
        SELECT *
        FROM course
        WHERE coach_id = #{coachId}
        <if test="date != null">
            AND course_date = #{date}
        </if>
        <if test="status != null and status != ''">
            AND status = #{status}
        </if>
        ORDER BY course_date DESC, start_time
    </select>

</mapper>